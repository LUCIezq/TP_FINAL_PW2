<link rel="stylesheet" href="/public/assets/barraTiempo.css">

{{#message}}
<div class="alert alert-info alert-dismissible fade show" role="alert">
    {{message}}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
{{/message}}

<div class="container text-center py-5">
    <div class="barra-tiempo-container">
        <div id="barra-tiempo"></div>
    </div>

    <input type="hidden" value="{{tiempo_restante}}" id="tiempo_restante">
    <input type="hidden" value="{{tiempo_limite}}" id="tiempo_limite">
    <input type="hidden" value="{{partida_id}}" id="partida_id">
    <input type="hidden" value="{{pregunta.id}}" id="pregunta_id">

    <div id="timer" class="timer-display">{{tiempo_restante}}s</div>

    <div class="bg-light p-4 rounded-3 mb-4 d-flex flex-column align-items-center">
        <div class="dropdown align-self-end">
            <button type="button" style="border:none; background:transparent;" data-bs-toggle="dropdown">
                <svg xmlns="http://www.w3.org/2000/svg" style="cursor:pointer;" width="16" height="16"
                    fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
                    <path
                        d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0" />
                </svg>
            </button>
            <ul class="dropdown-menu">
                <li>
                    <button type="button" class="dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModal">
                        Reportar
                    </button>
                </li>
            </ul>
        </div>

        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="exampleModalLabel">Reportar pregunta</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form action="/reporte/reportar" method="post">
                            <div class="mb-3">
                                <label for="motivo" class="form-label">Motivo del reporte:</label>
                                <select class="form-select" id="motivo" name="motivo" required>
                                    <option value="" selected disabled>Seleccione un motivo</option>
                                    <option value="Inexactitud">Respuesta/s incorrectas</option>
                                    <option value="Ofensivo">Ofensivo</option>
                                    <option value="Spam">Spam</option>
                                    <option value="Otro">Otro</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="detalle" class="form-label">Detalle (opcional):</label>
                                <textarea class="form-control" id="detalle" name="detalle" rows="3"></textarea>
                            </div>
                            <input type="hidden" name="pregunta_id" value="{{pregunta.id}}">
                            <input type="hidden" name="usuario_id" value="{{usuario_id}}">

                            <div class="mt-3 d-flex justify-content-end gap-2">
                                <button type="button" class="btn btn-secondary"
                                    data-bs-dismiss="modal">Cancelar</button>
                                <button type="submit" class="btn btn-primary">Enviar reporte</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <p id="preguntaTexto" class="fs-5 font-weight-bold">{{pregunta.texto}}</p>
    </div>

    <div id="respuestas-container" class="d-grid gap-3 col-6 mx-auto mt-4">
        {{#pregunta.respuestas}}
        <button type="button" class="btn btn-outline-primary btn-lg opcion-respuesta botones-respuesta"
            data-id="{{id}}">
            {{texto}}
        </button>
        {{/pregunta.respuestas}}
    </div>

    <div id="mensaje" class="mt-5 fs-4 fw-bold"></div>
</div>

<script type="module" src="/public/js/timer.js"></script>