<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Preguntados</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Reutilizamos el CSS del login/register -->
  <link href="/public/assets/register.css" rel="stylesheet">
  <!-- CSS de esta pantalla -->
  <link href="/public/assets/home.css" rel="stylesheet">

  <!-- Fuente estilo caricatura -->
  <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap" rel="stylesheet">
</head>
<body>

  <main class="container my-4">
    <h2 class="brand-title text-center">Preguntados</h2>
       {{#solicitud_errors}}
        <div class="alert alert-danger" role="alert">
          <span class="mb-0">
            {{.}}
          </span>
        </div>
        {{/solicitud_errors}}

        {{#solicitud_success}}
        <div class="alert alert-success" role="alert">
          {{solicitud_success}}
        </div>
        {{/solicitud_success}}
   
    <div class="container my-5">

      <div class="grid-home">
        <!-- ============ Partidas (izquierda) ============ -->
        <section class="panel-sky shadow-sm">
          <header class="panel-sky__header">
            <span class="panel-sky__title">Partidas</span>
          </header>


          

          <!-- Herramientas opcionales -->
          <div class="panel-sky__tools">
            <!-- ejemplo opcional de filtros -->
            <!--
            <select class="form-select form-select-sm w-auto">
              <option value="">Todas</option>
              <option value="pendiente">Pendientes</option>
              <option value="jugando">En juego</option>
              <option value="finalizada">Finalizadas</option>
            </select>
            -->
          </div>

          

          <!-- Lista de partidas -->
          <ul class="panel-sky__list">
            {{#partidas}}
            <li class="sky-item">
              <div class="sky-item__avatar">
                <img src="{{oponente_foto}}" alt="{{oponente_nombre}}">
              </div>

              <div class="sky-item__body">
                <div class="sky-item__topline">
                  <span class="sky-item__time">Hace {{hace}}</span>
                  {{#estado}}
                  <span class="badge bg-secondary rounded-pill">{{estado}}</span>
                  {{/estado}}
                </div>
                <div class="sky-item__title">
                  {{titulo}} <span class="text-muted">vs {{oponente_usuario}}</span>
                </div>
              </div>

              <div class="sky-item__actions">
                <button class="btn btn-light btn-icon" title="Aceptar / Continuar">
                  <i class="bi bi-check2-square"></i>
                </button>
                <button class="btn btn-light btn-icon" title="Ver detalles">
                  <i class="bi bi-camera"></i>
                </button>
              </div>
            </li>
            {{/partidas}}

            {{^partidas}}
            <li class="sky-empty">
              <span>No hay partidas todavía</span>
            </li>
            {{/partidas}}
          </ul>
        </section>


        <!-- = Últimos jugadores (derecha) = -->
        <section class="panel-beige shadow-sm">
          <header class="panel-beige__header">
            <span class="panel-beige__title">Jugadores Disponibles</span>
          </header>

          <ul class="panel-beige__list">
            {{#jugadores}}

            
            
            <li class="panel-beige__item ">
              <a class="panel-beige__avatar" href="/usuario/perfil/{{id_usuario}}">
                <img src="{{foto_perfil}}" alt="{{nombre}} {{apellido}}">
              </a>

              <div class="panel-beige__body">
                <a class="panel-beige__name" href="/usuario/perfil/{{id_usuario}}">
                  {{nombre}} {{apellido}}
                </a>
                <div class="panel-beige__meta">@{{nombre_usuario}}</div>
              </div>
              
              {{#puede_desafiar}}
              <button type="button"
                      class="btn btn-peach btn-sm panel-beige__action btn-desafiar"
                      data-destinatario-id="{{id_usuario}}">
                Desafiar
              </button>
              {{/puede_desafiar}}

              {{#solicitud_enviada}}
              <span class="badge bg-warning text-dark panel-beige__status">
                Solicitud Enviada 
                <i class="bi bi-clock-history"></i>
              </span>
              {{/solicitud_enviada}}

              {{#solicitud_recibida}}

              <div style="display: flex; flex-direction: column; gap: 5px; align-items: center;">
              <span class="badge bg-success text-white panel-beige__status">
                Solicitud Recibida
                <i class="bi bi-check-circle"></i>
              </span>

              <div style="display: flex; gap: 5px;align-items: center;">
                <form action="/solicitudPartida/aceptar" method="POST" class="panel-beige__form-aceptar">
                <input type="hidden" name="solicitud_id" value="{{id_solicitud}}">
                <button type="submit" class="btn btn-success btn-sm">
                  <i class="bi bi-check"></i>
                </button>
                </form>

                <form action="/solicitudPartida/rechazar" method="POST" class="panel-beige__form-rechazar">
                  <input type="hidden" name="solicitud_id" value="{{id_solicitud}}">
                  <button type="submit" class="btn btn-danger btn-sm">
                    <i class="bi bi-x"></i>
                  </button>
                </form>
              </div>
              </div>
              {{/solicitud_recibida}}
            </li>
            {{/jugadores}}

            {{^jugadores}}
            <li class="panel-beige__empty">
              <i class="bi bi-info-circle"></i> No hay jugadores disponibles en este momento.
            </li>
            {{/jugadores}}
          </ul>
        </section>
      </div>

      <!-- botón inferior crear preguntas -->
      <div class="mt-3">
        <a href="/preguntas/crear" class="btn btn-outline-primary btn-lg btn-create">
          <i class="bi bi-plus-circle"></i> Crear preguntas
        </a>
      </div>

      
      <form action="/solicitudPartida/crearSolicitudPartida" method="POST" class="form-desafiar">
        <input type="hidden" name="destinatario_id" id="destinatario_id">
      </form>
    </div>
  </main>

 
  <script src="/public/js/SaveUserId.js"></script>
</body>
</html>