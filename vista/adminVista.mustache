<link href="/public/assets/dashboardAdmin.css" rel="stylesheet">

<div class="admin-container">

    <!-- ========================= -->
    <!--       SIDEBAR ADMIN       -->
    <!-- ========================= -->
    <aside class="admin-sidebar">
        <h2 class="sidebar-title">ADMIN</h2>

        <ul class="sidebar-menu">
            <li><a href="/admin/index" class="active"> Dashboard</a></li>
            <li><a href="/editor/index"> Gesti贸n de Preguntas</a></li>
            <li><a href="/home/index"> Volver al Lobby</a></li>
            <li><a href="/login/logout"> Cerrar sesi贸n</a></li>
        </ul>
    </aside>

    <!-- ========================= -->
    <!--        MAIN CONTENT       -->
    <!-- ========================= -->
    <main class="admin-main">

        <h1 class="dashboard-title">Panel Administrativo</h1>

        <!-- FILTROS -->
        <div class="filter-bar">
            <label for="filtroPeriodo">Filtrar por:</label>
            <select id="filtroPeriodo">
                <option value="dia">Hoy</option>
                <option value="semana">ltima semana</option>
                <option value="mes">ltimo mes</option>
                <option value="anio">ltimo a帽o</option>
            </select>
        </div>

        <!-- ========================= -->
        <!--           KPIs            -->
        <!-- ========================= -->
        <div class="kpi-grid">

            <div class="kpi-card">
                <h4>Usuarios Registrados</h4>
                <p>{{totalUsuarios}}</p>
            </div>

            <div class="kpi-card">
                <h4>Partidas Jugadas</h4>
                <p>{{totalPartidas}}</p>
            </div>

            <div class="kpi-card">
                <h4>Preguntas Aprobadas</h4>
                <p>{{totalPreguntas}}</p>
            </div>

            <div class="kpi-card">
                <h4>Preguntas de Usuarios</h4>
                <p>{{totalPreguntasUsuarios}}</p>
            </div>

        </div>

        <!-- ========================= -->
        <!--         GRFICOS          -->
        <!-- ========================= -->

        <div class="charts-grid">

            <div class="chart-box">
                <h3>Usuarios por Pa铆s</h3>
                <canvas id="chartPais"></canvas>
            </div>

            <div class="chart-box">
                <h3>Distribuci贸n por Sexo</h3>
                <canvas id="chartSexo"></canvas>
            </div>

            <div class="chart-box">
                <h3>Distribuci贸n por Edad</h3>
                <canvas id="chartEdad"></canvas>
            </div>

            <div class="chart-box">
                <h3>% de Respuestas Correctas por Usuario</h3>
                <canvas id="chartPrecision"></canvas>
            </div>

        </div>

    </main>
</div>

<!-- ========================= -->
<!--        CHART JS CDN       -->
<!-- ========================= -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // Pa铆s
    new Chart(document.getElementById("chartPais"), {
        type: 'bar',
        data: {
            labels: dataPais.map(i => i.pais),
            datasets: [{
                label: "Usuarios",
                data: dataPais.map(i => i.cantidad),
                backgroundColor: '#1fb286'
            }]
        },
    });

    // Sexo
    new Chart(document.getElementById("chartSexo"), {
        type: 'pie',
        data: {
            labels: dataSexo.map(i => i.sexo),
            datasets: [{
                data: dataSexo.map(i => i.cantidad),
                backgroundColor: ["#1fb286", "#5a4ee3", "#f6c344"]
            }]
        }
    });

    // Edad
    new Chart(document.getElementById("chartEdad"), {
        type: 'bar',
        data: {
            labels: dataEdad.map(i => i.grupo),
            datasets: [{
                label: "Usuarios",
                data: dataEdad.map(i => i.cantidad),
                backgroundColor: "#5a4ee3"
            }]
        }
    });

    // Precisi贸n
    new Chart(document.getElementById("chartPrecision"), {
        type: 'line',
        data: {
            labels: dataPrecision.map(i => i.nombre_usuario),
            datasets: [{
                label: "% correctas",
                data: dataPrecision.map(i => i.porcentaje),
                borderColor: '#1fb286',
                borderWidth: 3,
                fill: false,
                tension: 0.3
            }]
        }
    });
</script>